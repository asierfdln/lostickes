{% extends "applostickes/base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<form method="POST">
  {% csrf_token %}
  {{ form | crispy }}
  <div id="app">
    <input type="button" style="display: inline;" class="btn btn-outline-info btn-block" value="Add User" @click="add" />
    <br /><br />
    <strong><p>Added users:</p></strong>
    <div id="added">
    </div>
    <br /><br />
    <input type="submit" class="btn btn-outline-secondary mr-2" value="Cancel" onclick="history.back()" />
    <input type="submit" class="btn btn-outline-info" value="Submit" />
    <br /><br />
    
  </div>
  
</form>
<script type="text/javascript">
  new Vue({
    el: "#app",
    data:{
      users: []
    },
    methods:{
      add: function(){

        // ################################################################################
        // EMPEZAMOS LA EXPLICACION EN PSEUDOCODIGO...
        // ################################################################################

        // coges el elemento "users" del html (no confundir con el "users = []" de Vue)
        var f = document.getElementsByName("users");

        // obtienes el elemento seleccionado de f, el "user"
        // var user = nosecomolohasestadohaciendo...;

        // miras a ver si el "user" que has obtenido (el "var user" de arriba esta en el "users" de Vue)

        // ############## OJO a esto ##############
        // >>> a = ["a","b"]
        // Array [ "a", "b" ]
        // >>> a.includes("a")
        // true
        // ############## OJO a esto ##############

        // if (this.users.includes(user)) {
        //   pues_no_lo_metas_en_users_de_vue();
        //   pues_no_lo_metas_en_html_con_el_append();
        // } else {
        //   pues_me_lo_metes_atope_en_users_de_vue();
        //   pues_me_lo_metes_atope_en_html_con_el_append();
        // }

        // ########################################
        // NO HACE FALTA HACER NINGUN FOR PARA NADA
        // ########################################

        // ################################################################################
        // FIN DE LA EXPLICACION EN PSEUDOCODIGO...
        // ################################################################################

        $("#added").append(
          '<button style="display: inline;" type="button" class="btn btn-outline-danger mr-4" @click="remove">' +
            '<span>&times;</span>' +
          '</button>' +
          '<p name="users_group" style="display: inline;" value="'+f[0][f[0].selectedIndex].value+'">' +
            f[0][f[0].selectedIndex].outerText +
          '</p>' +
          '<br />'
        );

        for(var e = 0; e < (this.users.length); e++){
          if(this.users[e] == f[0][f[0].selectedIndex].outerText){
            console.log("existe");
            this.users.pop();
            
          }
          else{
            console.log("NOexiste");
          }
          
        }
        this.users.push(f[0][f[0].selectedIndex].outerText);
        
        console.log(this.users.length);
      },

      remove: function(){
        console.log("and I say... HEEEEEEEEEEEEYEEEEEEEEEEYEEEEEEEEEEEYEYE");
      }
    }
  });
</script>
{% endblock content %}
{%block side %}
<div id="sidebar" class="col-md-4">
  <div class="content-section">
    <h3>Options</h3>
    <p class='text-muted'>
    <ul class="list-group">
      <li class="list-group-item list-group-item-light"><a class="article-title" href="{% url 'user' %}">Home</a></li>
      <li class="list-group-item list-group-item-light"><a class="article-title" href="{% url 'groups' %}">Groups</a>
      </li>
      <li class="list-group-item list-group-item-light"><a class="article-title" href="{% url 'debts' %}">Debts</a></li>
      <li class="list-group-item list-group-item-light"><a class="article-title" href="#">Create group</a></li>
    </ul>
    </p>
  </div>
</div>
{% endblock side %}